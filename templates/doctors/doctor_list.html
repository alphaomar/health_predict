{#{% extends 'base/index.html' %}#}
{#{% load static %}#}
{##}
{#{% block content %}#}
{#<!-- Doctor List Section -->#}
{#<section class="ftco-section">#}
{#    <div class="container">#}
{#        <!-- Search & Filters Section -->#}
{#        <div class="row mb-4">#}
{#            <div class="col-md-12">#}
{#                <form method="GET" action="{% url 'core:doctor_list' %}" class="form-inline">#}
{#                    <input type="text" name="q" class="form-control mr-2" placeholder="Search by name or specialization" value="{{ search_query }}">#}
{#                    <select name="specialization" class="form-control mr-2">#}
{#                        <option value="">Specialization</option>#}
{#                        {% for spec in specializations %}#}
{#                        <option value="{{ spec }}" {% if spec == selected_specialization %}selected{% endif %}>{{ spec }}</option>#}
{#                        {% endfor %}#}
{#                    </select>#}
{#                    <select name="disease" class="form-control mr-2">#}
{#                        <option value="">Disease</option>#}
{#                        {% for disease in diseases %}#}
{#                        <option value="{{ disease.id }}" {% if disease.id == selected_disease %}selected{% endif %}>{{ disease.name }}</option>#}
{#                        {% endfor %}#}
{#                    </select>#}
{#                    <input type="text" name="location" class="form-control mr-2" placeholder="Location" value="{{ selected_location }}">#}
{#                    <button type="submit" class="btn btn-primary mr-2">Search</button>#}
{#                    #}
{#                    {% if filters_applied %}#}
{#                    <a href="{% url 'core:doctor_list' %}" class="btn btn-secondary">Reset</a>#}
{#                    {% endif %}#}
{#                </form>#}
{#            </div>#}
{#        </div>#}
{##}
{#        <!-- Doctors List -->#}
{#        <div class="row">#}
{#            {% for doctor in doctors %}#}
{#            <div class="col-md-6 col-lg-4 mb-4">#}
{#                <div class="card doctor-card">#}
{#                    <img src="{{ doctor.profile_picture.url }}" class="card-img-top" alt="{{ doctor.user.get_full_name }}">#}
{#                    <div class="card-body">#}
{#                        <h5 class="card-title"><a href="#">{{ doctor.user.get_full_name }}</a></h5>#}
{#                        <p class="card-text">Specialization: {{ doctor.specialization }}</p>#}
{#                        <p class="card-text">Consultation Fee: ${{ doctor.consultation_fee }}</p>#}
{#                        <p class="card-text">Experience: {{ doctor.years_of_experience }} years</p>#}
{#                        <a href="#" class="btn btn-outline-primary btn-sm">View Profile</a>#}
{#                        <a href="#" class="btn btn-outline-success btn-sm">Book Appointment</a>#}
{#                    </div>#}
{#                </div>#}
{#            </div>#}
{#            {% empty %}#}
{#            <div class="col-12">#}
{#                <p>No doctors found.</p>#}
{#            </div>#}
{#            {% endfor %}#}
{#        </div>#}
{##}
{#        <!-- Pagination -->#}
{#        <div class="row mt-5">#}
{#            <div class="col text-center">#}
{#                <div class="block-27">#}
{#                    <ul class="pagination">#}
{#                        {% if page_obj.has_previous %}#}
{#                        <li class="page-item"><a class="page-link" href="?page=1">&laquo;</a></li>#}
{#                        <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">&lsaquo;</a></li>#}
{#                        {% endif %}#}
{#                        {% for num in page_obj.paginator.page_range %}#}
{#                        <li class="page-item {% if num == page_obj.number %}active{% endif %}"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>#}
{#                        {% endfor %}#}
{#                        {% if page_obj.has_next %}#}
{#                        <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">&rsaquo;</a></li>#}
{#                        <li class="page-item"><a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">&raquo;</a></li>#}
{#                        {% endif %}#}
{#                    </ul>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}

{% extends 'base/index.html' %}
{% load static %}

{% block content %}
<!-- Doctor List Section -->
{#<section class="ftco-section">#}
{#    <div class="container">#}
{#        <!-- Search & Filters Section -->#}
{#        <div class="row mb-4">#}
{#            <div class="col-md-12">#}
{#                <form method="GET" action="{% url 'core:doctor_list' %}" class="form-inline">#}
{#                    <input type="text" name="q" class="form-control mr-2" placeholder="Search by name or specialization" value="{{ search_query }}">#}
{#                    <select name="specialization" class="form-control mr-2">#}
{#                        <option value="">Specialization</option>#}
{#                        {% for spec in specializations %}#}
{#                        <option value="{{ spec }}" {% if spec == selected_specialization %}selected{% endif %}>{{ spec }}</option>#}
{#                        {% endfor %}#}
{#                    </select>#}
{#                    <select name="disease" class="form-control mr-2">#}
{#                        <option value="">Disease</option>#}
{#                        {% for disease in diseases %}#}
{#                        <option value="{{ disease.id }}" {% if disease.id == selected_disease %}selected{% endif %}>{{ disease.name }}</option>#}
{#                        {% endfor %}#}
{#                    </select>#}
{#                    <select name="hospital" class="form-control mr-2">#}
{#    <option value="">Hospital</option>#}
{#    {% for hospital in hospitals %}#}
{#    <option value="{{ hospital.id }}" {% if hospital.id == selected_hospital %}selected{% endif %}>{{ hospital.name }}</option>#}
{#    {% endfor %}#}
{#</select>#}
{#                    <button type="submit" class="btn btn-primary btn-sm mr-2">Search</button>#}
{#                    #}
{#                    {% if filters_applied %}#}
{#                    <a href="{% url 'core:doctor_list' %}" class="btn btn-secondary btn-sm">Reset</a>#}
{#                    {% endif %}#}
{#                </form>#}
{#            </div>#}
{#        </div>#}
{##}
{#        <!-- Doctors List -->#}
{#        <div class="row">#}
{#            {% for doctor in doctors %}#}
{#            <div class="col-md-6 col-lg-4 mb-4">#}
{#                <div class="card doctor-card">#}
{#                    <img src="{{ doctor.profile_picture.url }}" class="card-img-top" alt="{{ doctor.user.get_full_name }}">#}
{#                    <div class="card-body">#}
{#                        <h5 class="card-title">#}
{#                            <a href="{% url 'core:doctor_detail' doctor.id %}">Dr. {{ doctor.user.first_name|title }} {{ doctor.user.last_name |title }}</a>#}
{#                        </h5>#}
{#                        <p class="card-text">Specialization: {{ doctor.specialization }}</p>#}
{#                        <p class="card-text">Consultation Fee: Nle {{ doctor.consultation_fee |default_if_none:"" }}</p>#}
{#                        <p class="card-text">Experience: {{ doctor.years_of_experience }} years</p>#}
{#                        <p class="card-text">Hospital: {{ doctor.hospital.name }}</p>#}
{#                        <a href="{% url 'core:doctor_detail' doctor.id %}" class="btn btn-outline-primary btn-xs">View Profile</a>#}
{#                        <a href="#" class="btn btn-outline-success btn-xs">Book Appointment</a>#}
{#                        #}
{#                    </div>#}
{#                </div>#}
{#            </div>#}
{#            {% empty %}#}
{#            <div class="col-12">#}
{#                <p>No doctors found.</p>#}
{#            </div>#}
{#            {% endfor %}#}
{#        </div>#}
{##}
{#        <!-- Pagination -->#}
{#        <div class="row mt-5">#}
{#            <div class="col text-center">#}
{#                <div class="block-27">#}
{#                    <ul class="pagination">#}
{#                        {% if page_obj.has_previous %}#}
{#                        <li class="page-item"><a class="page-link" href="?page=1">&laquo;</a></li>#}
{#                        <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">&lsaquo;</a></li>#}
{#                        {% endif %}#}
{#                        {% for num in page_obj.paginator.page_range %}#}
{#                        <li class="page-item {% if num == page_obj.number %}active{% endif %}"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>#}
{#                        {% endfor %}#}
{#                        {% if page_obj.has_next %}#}
{#                        <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">&rsaquo;</a></li>#}
{#                        <li class="page-item"><a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">&raquo;</a></li>#}
{#                        {% endif %}#}
{#                    </ul>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{#    </div>#}
{#</section>#}
    <section class="ftco-section">
    <div class="container">
        <div class="row mb-4">
            <div class="col-md-12">
                <form id="filter-form" method="GET" action="{% url 'core:doctor_list' %}" class="form-inline">
                    <input type="text" name="q" id="search-query" class="form-control mr-2" placeholder="Search by name or specialization" value="{{ search_query }}">
                    <select name="specialization" id="specialization-filter" class="form-control mr-2">
                        <option value="">Specialization</option>
                        {% for spec in specializations %}
                        <option value="{{ spec }}" {% if spec == selected_specialization %}selected{% endif %}>{{ spec }}</option>
                        {% endfor %}
                    </select>
                    <select name="disease" id="disease-filter" class="form-control mr-2">
                        <option value="">Disease</option>
                        {% for disease in diseases %}
                        <option value="{{ disease.id }}" {% if disease.id == selected_disease %}selected{% endif %}>{{ disease.name }}</option>
                        {% endfor %}
                    </select>
                    <select name="hospital" id="hospital-filter" class="form-control mr-2">
                        <option value="">Hospital</option>
                        {% for hospital in hospitals %}
                        <option value="{{ hospital.id }}" {% if hospital.id == selected_hospital %}selected{% endif %}>{{ hospital.name }}</option>
                        {% endfor %}
                    </select>
                </form>
            </div>
        </div>

        <!-- Doctors List -->
        <div id="doctor-list-container">
            {% include 'doctors/includes/doctor_list.html' %}
        </div>

    </div>
</section>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const filterForm = document.getElementById('filter-form');

    function sendAjaxRequest() {
        const formData = new FormData(filterForm);
        const queryString = new URLSearchParams(formData).toString();

        fetch(`{% url 'core:doctor_list' %}?${queryString}`, {
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById('doctor-list-container').innerHTML = data.html;
        })
        .catch(error => console.error('Error:', error));
    }

    // Attach the event listeners to the filters and search inputs
    filterForm.addEventListener('input', sendAjaxRequest);  // Trigger AJAX on input
});
</script>
{% endblock content %}

{% block style %}
<style>
    body {
        font-family: 'Roboto', sans-serif;
        background-color: #f8f9fa;
    }

    .form-control {
        border-radius: 0.25rem;
        margin-bottom: 1rem;
    }

    .doctor-card {
        border: 1px solid #ddd;
        border-radius: 0.5rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        background: #fff;
        transition: box-shadow 0.3s ease;
        text-align: center;
    }

    .doctor-card:hover {
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }

    .card-img-top {
        width: 100%;
        height: 250px;
        object-fit: cover;
    }

    .card-title {
        font-size: 1.25rem;
        color: #333;
        margin-bottom: 0.75rem;
    }

    .card-text {
        color: #555;
        margin-bottom: 0.5rem;
    }

    .btn-outline-primary, .btn-outline-success {
        width: 48%;
        margin-top: 0.75rem;
        border-radius: 20px;
        font-size: 0.75rem;
    }

    .btn-outline-primary:hover, .btn-outline-success:hover {
        background-color: #007bff;
        color: #fff;
    }

    .pagination {
        display: flex;
        justify-content: center;
        margin-top: 2rem;
    }

    .pagination .page-item .page-link {
        color: #007bff;
        border-radius: 0.25rem;
        border: 1px solid #ddd;
        padding: 0.5rem 0.75rem;
    }

    .pagination .page-item.active .page-link {
        background-color: #007bff;
        color: #fff;
        border-color: #007bff;
    }
</style>
{% endblock %}
