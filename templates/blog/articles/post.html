{% extends 'base/index.html' %}
{% load static %}
{% block content %}

<section id="postcontent">

<section id="detail">
    <div class="detail-head">
        <h3>{{ post.title }}</h3>
        <p>by {{ post.author.first_name }} {{ post.author.last_name }}| on {{ post.created_at }}| in {% for tag in post.tags.all %}<a href="{% url 'blog:tag_posts' tag.name %}">{{ tag.name }}, </a>{% endfor %}</p>
    </div>
    <div class="detail-img">
        <img src="{{ post.image.url }}" alt="">
    </div>
    <div class="detail-content">
        <p>{{ post.content|safe }}</p>
    </div>
<h3>Author</h3>
    <div class="detail-author">
        <div>
            <img src="{% static 'core/assest/images/team/1.jpg' %}" alt="">
        </div>
        <div class="author">
            <h4>{{ post.author.first_name }} {{ post.author.last_name }}</h4>
            <small>{{ post.author.role }}</small>
        </div>
    </div>
    <section id="comments">    
        <h3>Leave a Comment:</h3>
        <form method="post" class="comment-form">
            {% csrf_token %}
            {{ comment_form }}
            <button type="submit" class="butt">Submit Comment</button>
        </form>
            <div id="comments-section">
            <h3 style="margin: 15px 0;">Comments</h3>
        {% for comment in comments %}
            <div class="comment" id="comment-{{ comment.id }}" >
            <strong style="color: darkred">{{ comment.author_name}}</strong>
            <p style="color: black">{{ comment.content }}</p>
            <small>{{ comment.created_at }}</small>
            </div>
        {% endfor %}
            </div>
    </section>
</section>

    <section id="sidebar">
                <div class="sidebar">
        <div class="side-logo">
            <h2>Blog Resources</h2>
        </div>

        <div class="sidebar-menu">
            <div class="menu-section">
                <h3>Categories</h3>
                <ul>
                    {% for category in categories %}
                    	<li><a href="{% url 'blog:category_posts' category.name %}">{{ category.name }}</a> <span style="color: blue">({{ category.post_count }})</span></li>
                    {% endfor %}
                </ul>
            </div>

            <div class="menu-section">
                <h3>Doctors</h3>
                <ul>
                    {% for doctor in doctors %}
                    	 <li><a href="{% url 'blog:doctor_posts' doctor.id %}">{{ doctor.first_name }} {{ doctor.last_name }}</a></li>
                    {% endfor %}
                </ul>
            </div>

            <div class="menu-section">
                <h3>Diseases</h3>
                <ul>
                    {% for disease in diseases %}
                    	<li><a href="{% url 'blog:disease_posts' disease.id %}">{{ disease.name }}</a><span style="color: blue">({{ disease.post_count }})</span></li>
                    {% endfor %}
                </ul>
            </div>

            <div class="menu-section">
                <h3>Tags</h3>
                <ul>
                    {% for tag in tags %}
                    	<li><a href="{% url 'blog:tag_posts' tag.name %}">{{ tag.name }}</a><span style="color: blue">({{ tag.post_count }})</span></li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
        </section>
</section>


    <section id="related_docs" class="r-posts">
        <h3>RELATED POSTS</h3>
        <div class="posts">
            {% for related_post in related_posts %}
            <div class="post-card">
                <div class="post-head">
                    {% if related_post.image %}
                    	<img src="{{ related_post.image.url }}" alt="">
                    {% endif %}
                </div>
                <div class="post-body">
                    <span class="tag tag-teal">{{ related_post.slug }}</span>
                    <h4>
                        <a href="{% url 'blog:post-detail' related_post.id %}">{{ related_post.title|title }}</a>
                    </h4>
                    <p>
                      {{ related_post.content|truncatewords:30|safe }}
                    </p>
                    <div class="user-info">
                        <h5>{{ related_post.author.first_name }}</h5>
                        <small>{{ related_post.created_at }}</small>
                    </div>
                </div>
                
            </div>
            {% endfor %}
        </div>
    </section>
    
<section id="related_docs" class="d-posts">
    <h3>RELATED DOCTORS</h3>
    <div class="docs">
        {% for related_doctor in related_doctors %}
        <div class="infocardContainer">
        <div id="main">
            {% if related_doctor.doctorprofile.profile_picture %}
                <img src="{{ related_doctor.doctorprofile.profile_picture.url }}"  alt="{{ related_doctor.first_name }} {{ related_doctor.lats_name }}">
            {% endif %}
        </div>
        <div id="textbois">
          <h2> {{ related_doctor.first_name|title }} {{ related_doctor.last_name |truncatechars:3 }}</h2>
          <h4> {{ related_doctor.doctorprofile.specialization }}</h4>
          <a href="mailto:limecicila@gmail.com">View Profile</a>
            
        </div>
      </div>
            {% empty %}
            <div>
                <h4>No doctor found!!</h4>
            </div>
    {% endfor %}
    </div>
    
 </section>   
    
    {% block scripts %}
        <script>
              tinymce.init({
                selector: 'textarea',
                plugins: 'advlist autolink lists link image charmap preview anchor searchreplace visualblocks code fullscreen insertdatetime media table paste code help wordcount',
                toolbar: 'undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help',
              });
                  // JavaScript to toggle reply forms
                document.querySelectorAll('.reply-button').forEach(function(button) {
                    button.addEventListener('click', function(event) {
                        event.preventDefault();
                        var commentId = button.getAttribute('data-comment-id');
                        var replyForm = document.getElementById('reply-form-' + commentId);
                        replyForm.style.display = (replyForm.style.display === 'none' ? 'block' : 'none');
                    });
                });
        </script>
    {% endblock %}
{% endblock %}
{% block style %}
    	<link rel="stylesheet" href="{% static 'core/assest/css/background.css' %}">
        <link rel="stylesheet" href="{% static 'core/assest/css/post.css' %}">
{% endblock %}




